(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[411],{9089:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/onboarding",function(){return a(165)}])},9352:function(e,t,a){"use strict";a.d(t,{Z:function(){return d}});var n=a(5893),r=a(7294),i=a(9583),s=a(9413),l=a(6223),o=a(155);function c(e){let{setImage:t,hidePhotoLibrary:a}=e;return(0,n.jsx)("div",{className:"fixed top-0 left-0 max-h-[100vh] max-w-[100vw] h-full w-full flex justify-center items-center",children:(0,n.jsxs)("div",{className:" h-max w-max   bg-gray-900  gap-6 rounded-lg p-4",children:[(0,n.jsx)("div",{className:"pt-2 pr-2 cursor-pointer flex items-end justify-end",onClick:()=>a(!1),children:(0,n.jsx)(o.bjh,{className:"h-10 w-10"})}),(0,n.jsx)("div",{className:"grid grid-cols-3 justify-center items-center  gap-16 p-20 w-full",children:["avatars/1.png","avatars/2.png","avatars/3.png","avatars/4.png","avatars/5.png","avatars/6.png","avatars/7.png","avatars/8.png","avatars/9.png"].map((e,r)=>(0,n.jsx)("div",{onClick:async()=>{let n=document.querySelector("[data-avatar=avatar-".concat(r,"]")),i=await fetch(null==n?void 0:n.src);await i.blob();let s=new FileReader;s.onloadend=()=>{t(s.result)},a(!1),t(e)},className:"cursor-pointer",children:(0,n.jsx)("img",{src:e,alt:"avatar",className:"h-24 w-24","data-avatar":"avatar-".concat(r)})},e))})]})})}function u(e){let{setImage:t,hide:a}=e,i=(0,r.useRef)();(0,r.useEffect)(()=>{let e;let t=async()=>{e=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1}),i.current.srcObject=e};return t(),()=>{null==e||e.getTracks().forEach(e=>e.stop())}},[]);let s=()=>{var e;let n=document.createElement("canvas");null===(e=n.getContext("2d"))||void 0===e||e.drawImage(i.current,0,0,300,150),t(n.toDataURL("image/jpeg")),a(!1)};return(0,n.jsxs)("div",{className:"absolute h-4/6 w-2/6 top-1/4 left-1/3 bg-gray-900 flex-col gap-3 rounded-lg pt-2 flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-4 w-full",children:[(0,n.jsx)("div",{className:"pt-2 pr-2 cursor-pointer flex items-end justify-end",onClick:()=>a(!1),children:(0,n.jsx)(o.bjh,{className:"h-10 w-10"})}),(0,n.jsx)("div",{className:"flex justify-center",children:(0,n.jsx)("video",{id:"video",width:"400",autoPlay:!0,ref:i})})]}),(0,n.jsx)("button",{className:" h-16 w-16 bg-white rounded-full cursor-pointer border-8 border-teal-light p-2 mb-10",onClick:s})]})}function d(e){let{type:t,image:a,setImage:o}=e,[d,h]=(0,r.useState)(!1),[g,f]=(0,r.useState)(!1),[m,p]=(0,r.useState)(!1),[v,x]=(0,r.useState)(!1),[b,j]=(0,r.useState)(!0),[w,y]=(0,r.useState)(!1),[k,N]=(0,r.useState)({x:0,y:0});(0,r.useEffect)(()=>{if(m){let e=document.getElementById("photo-picker");e.click(),document.body.onfocus=e=>{p(!1)}}},[m]),(0,r.useEffect)(()=>{let e=()=>{b?j(!1):(x(!1),j(!0))};return v&&window.addEventListener("click",e),()=>window.removeEventListener("click",e)},[v,b]);let E=e=>{e.preventDefault(),N({x:e.pageX,y:e.pageY}),x(!0)},S=async e=>{let t=e.target.files[0],a=new FileReader,n=document.createElement("img");a.onload=function(e){n.src=e.target.result,n.setAttribute("data-src",e.target.result)},a.readAsDataURL(t),setTimeout(()=>{o(n.src)},100)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex items-center justify-center",children:["sm"===t&&(0,n.jsx)("img",{src:a,alt:"avatar",className:"h-10 w-10 rounded-full"}),"lg"===t&&(0,n.jsx)("img",{src:a,alt:"avatar",className:"h-14 w-14 rounded-full"}),"xl"===t&&(0,n.jsxs)("div",{className:"relative cursor-pointer z-0",onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),children:[(0,n.jsxs)("div",{className:"bg-photopicker-overlay-background h-60 w-60 absolute top-0 left-0 rounded-full flex items-center justify-center flex-col text-center gap-2 ".concat(d?"visible":"hidden"),id:"context-opener",onClick:e=>E(e),children:[(0,n.jsx)(i.Dmm,{className:"text-2xl",id:"context-opener",onClick:e=>E(e)}),(0,n.jsxs)("span",{className:"",id:"context-opener",onClick:e=>E(e),children:["Change ",(0,n.jsx)("br",{})," Profile ",(0,n.jsx)("br",{})," Photo"]})]}),(0,n.jsx)("div",{className:"flex items-center justify-center",children:(0,n.jsx)("img",{src:a,alt:"avatar",className:"h-60 w-60 rounded-full object-cover "})})]})]}),v&&(0,n.jsx)(s.Z,{options:[{name:"Take Photo",callBack:()=>{x(!1),y(!0)}},{name:"Choose from Library",callBack:()=>{x(!1),f(!0)}},{name:"Upload Photo",callBack:()=>{x(!1),p(!0)}},{name:"Remove Photo",callBack:()=>{x(!1),o("/default_avatar.png")}}],cordinates:k,contextMenu:v,setContextMenu:x}),m&&(0,n.jsx)(l.Z,{onChange:S}),g&&(0,n.jsx)(c,{setImage:o,hidePhotoLibrary:f}),w&&(0,n.jsx)(u,{setImage:o,hide:y})]})}},9413:function(e,t,a){"use strict";a.d(t,{Z:function(){return i}});var n=a(5893),r=a(7294);function i(e){let{options:t,cordinates:a,contextMenu:i,setContextMenu:s}=e,l=(0,r.useRef)(null);(0,r.useEffect)(()=>{let e=e=>{"context-opener"!==e.target.id&&l.current&&!l.current.contains(e.target)&&s(!1)};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[]),(0,r.useEffect)(()=>{let e=e=>{"Escape"===e.key&&i&&s(!1)};return window.addEventListener("keyup",e),()=>window.removeEventListener("keyup",e)},[]);let o=(e,t)=>{e.stopPropagation(),t()};return(0,n.jsx)("div",{className:"bg-dropdown-background fixed py-2 z-[100]",ref:l,style:{boxShadow:"0 2px 5px 0 rgba(var(11,20,26),.26),0 2px 10px 0 rgba(11,20,26;),.16)",top:a.y,left:a.x},children:(0,n.jsx)("ul",{children:t.map(e=>{let{name:t,callBack:a}=e;return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("li",{className:"hover:bg-background-default-hover px-5 py-2 cursor-pointer",onClick:e=>o(e,a),children:(0,n.jsx)("span",{className:"text-white",children:t})})})})})})}},6223:function(e,t,a){"use strict";a.d(t,{Z:function(){return i}});var n=a(5893);a(7294);var r=a(3935);function i(e){let{onChange:t}=e,a=(0,n.jsx)("input",{type:"file",hidden:!0,id:"photo-picker",onChange:t});return r.createPortal(a,document.getElementById("photo-picker-element"))}},165:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p}});var n=a(5893),r=a(7294),i=a(9352);function s(e){let{name:t,state:a,setState:r,label:i=!1}=e;return(0,n.jsxs)("div",{className:"flex gap-1 flex-col",children:[i&&(0,n.jsx)("label",{htmlFor:t,className:"text-teal-light text-lg px-1",children:t}),(0,n.jsx)("div",{children:(0,n.jsx)("input",{name:t,type:"text",value:a,onChange:e=>r(e.target.value),className:"bg-input-background text-sm focus:outline-none text-white h-10 rounded-lg pl-5 pr-5 py-4 w-full"})})]})}var l=a(6154),o=a(58),c=a(6770),u=a.n(c),d=a(5675),h=a.n(d),g=a(1701),f=a(1163),m=a(9149);function p(){let e=(0,f.useRouter)(),[{userInfo:t,newUser:a},c]=(0,g.C4)(),[d,p]=(0,r.useState)("/default_avatar.png"),[v,x]=(0,r.useState)((null==t?void 0:t.name)||""),[b,j]=(0,r.useState)("");(0,r.useEffect)(()=>{a||(null==t?void 0:t.email)?!a&&(null==t?void 0:t.email)&&e.push("/"):e.push("/login")},[a,t,e]);let w=e=>new Promise(t=>{u().imageFileResizer(e,300,300,"PNG",80,0,e=>{t(e)},"base64")}),y=async()=>{if(k()){let a=null==t?void 0:t.email;try{let t=await fetch("".concat(d)),n=await t.blob();p(await w(n));let{data:r}=await l.Z.post(o.CU,{email:a,name:v,about:b,image:d});r.status&&(c({type:m.J.SET_NEW_USER,newUser:!1}),c({type:m.J.SET_USER_INFO,userInfo:{name:v,email:a,profileImage:d,status:b}}),e.push("/"))}catch(e){console.log(e)}}},k=()=>!(v.length<3);return(0,n.jsxs)("div",{className:"bg-panel-header-background h-screen w-screen text-white flex flex-col items-center justify-center",children:[(0,n.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,n.jsx)(h(),{src:"/whatsapp.gif",alt:"whatsapp-gif",height:300,width:300}),(0,n.jsx)("span",{className:"text-7xl",children:"WhatsApp"})]}),(0,n.jsx)("div",{}),(0,n.jsx)("h2",{className:"text-2xl ",children:"Create your profile"}),(0,n.jsxs)("div",{className:"flex gap-6 mt-6 ",children:[(0,n.jsxs)("div",{className:"flex flex-col items-center justify-between mt-5 gap-6",children:[(0,n.jsx)(s,{name:"Display Name",state:v,setState:x,label:!0}),(0,n.jsx)(s,{name:"About",state:b,setState:j,label:!0}),(0,n.jsx)("div",{className:"flex items-center justify-center",children:(0,n.jsx)("button",{className:"bg-search-input-container-background p-5 rounded-lg",onClick:y,children:"Create Profile"})})]}),(0,n.jsx)("div",{children:(0,n.jsx)(i.Z,{type:"xl",image:d,setImage:p})})]})]})}},58:function(e,t,a){"use strict";a.d(t,{CU:function(){return s},Hj:function(){return f},M5:function(){return n},MZ:function(){return c},OZ:function(){return g},To:function(){return o},co:function(){return u},gS:function(){return l},vp:function(){return d},yQ:function(){return h}});let n="http://localhost:5005",r="".concat(n,"/api/auth"),i="".concat(n,"/api/messages"),s="".concat(r,"/onboarduser"),l="".concat(r,"/check-user"),o="".concat(r,"/get-contacts"),c="".concat(r,"/generate-token"),u="".concat(i,"/add-message"),d="".concat(i,"/get-messages"),h="".concat(i,"/get-initial-contacts"),g="".concat(i,"/add-audio-message"),f="".concat(i,"/add-image-message")},1163:function(e,t,a){e.exports=a(6885)},6770:function(e){(()=>{"use strict";var t={d:(e,a)=>{for(var n in a)t.o(a,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:a[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},a={};t.r(a),t.d(a,{default:()=>r});var n=function(){var e;function t(){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t)}return e=[{key:"changeHeightWidth",value:function(e,t,a,n,r,i){return a>n&&(e=Math.round(e*n/a),a=n),e>t&&(a=Math.round(a*t/e),e=t),r&&a<r&&(e=Math.round(e*r/a),a=r),i&&e<i&&(a=Math.round(a*i/e),e=i),{height:e,width:a}}},{key:"resizeAndRotateImage",value:function(e,t,a,n,r){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"jpeg",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:100,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,o=document.createElement("canvas"),c=e.width,u=e.height,d=this.changeHeightWidth(u,a,c,t,n,r);l&&(90===l||270===l)?(o.width=d.height,o.height=d.width):(o.width=d.width,o.height=d.height),c=d.width,u=d.height;var h=o.getContext("2d");return h.fillStyle="rgba(0, 0, 0, 0)",h.fillRect(0,0,c,u),h.imageSmoothingEnabled&&h.imageSmoothingQuality&&(h.imageSmoothingQuality="high"),l&&(h.rotate(l*Math.PI/180),90===l?h.translate(0,-o.width):180===l?h.translate(-o.width,-o.height):270===l?h.translate(-o.height,0):0!==l&&360!==l||h.translate(0,0)),h.drawImage(e,0,0,c,u),o.toDataURL("image/".concat(i),s/100)}},{key:"b64toByteArrays",value:function(e,t){t=t||"image/jpeg";for(var a=atob(e.toString().replace(/^data:image\/(png|jpeg|jpg|webp);base64,/,"")),n=[],r=0;r<a.length;r+=512){for(var i=a.slice(r,r+512),s=Array(i.length),l=0;l<i.length;l++)s[l]=i.charCodeAt(l);var o=new Uint8Array(s);n.push(o)}return n}},{key:"b64toBlob",value:function(e,t){var a=this.b64toByteArrays(e,t);return new Blob(a,{type:t,lastModified:new Date})}},{key:"b64toFile",value:function(e,t,a){var n=this.b64toByteArrays(e,a);return new File(n,t,{type:a,lastModified:new Date})}},{key:"createResizedImage",value:function(e,a,n,r,i,s,l){var o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"base64",c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,d=new FileReader;if(!e)throw Error("File Not Found!");if(e.type&&!e.type.includes("image"))throw Error("File Is NOT Image!");d.readAsDataURL(e),d.onload=function(){var h=new Image;h.src=d.result,h.onload=function(){var d=t.resizeAndRotateImage(h,a,n,c,u,r,i,s),g="image/".concat(r);switch(o){case"blob":l(t.b64toBlob(d,g));break;case"base64":default:l(d);break;case"file":var f=e.name.toString().replace(/(png|jpeg|jpg|webp)$/i,"").concat(r.toString());l(t.b64toFile(d,f,g))}}},d.onerror=function(e){throw Error(e)}}}],function(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t,e),t}();let r={imageFileResizer:function(e,t,a,r,i,s,l,o,c,u){return n.createResizedImage(e,t,a,r,i,s,l,o,c,u)}};e.exports=a})()}},function(e){e.O(0,[445,260,354,774,888,179],function(){return e(e.s=9089)}),_N_E=e.O()}]);